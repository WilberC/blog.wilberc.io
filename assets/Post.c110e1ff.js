import{G as E,$ as B,_ as N,d as q,u as D,h as f,l as R,m as z,n as A,S as V,o as l,b as c,w as h,e as P,T as W,g as s,a as O,s as H,k as U,v as j,q as L,p as G,i as M,U as Y}from"./app.b2cd1fc0.js";import{A as I,P as J}from"./Page.4b2adcd1.js";import{u as K,C as Q}from"./Common.b03a2fa6.js";import{P as X}from"./Pager.a4f0725e.js";import"./resolveTime.bbe121e0.js";const k=({headers:x,activeLink:n})=>{const r=E();return B("ul",{class:{catalog:!0}},x.map(o=>B("li",{class:{active:n===o.slug,[`level-${o.level}`]:!0,[`toc-link-${o.slug}`]:!0},key:o.title,onClick:()=>{r.currentRoute.value.hash!==`#${o.slug}`&&r.push(`#${o.slug}`)}},o.title)))};k.displayName="Catalog";k.props={headers:{type:Object,required:!0},activeLink:{type:String,default:""}};const m=40,S=80,Z=q({__name:"Post",setup(x){const n=M(),r=D(),o=E(),_=Y(),$=_.resolve,b=_.pending,i=K(),F=f(()=>i.value?n.value.headers:[]),w=t=>t.children.length>0?[t].concat(...t.children.map(w)):t,u=f(()=>[].concat(...F.value.map(w))),e=R({headerHeight:0,screenWidth:0,catalogTop:0,activeLink:"",isFixed:!1}),p=()=>{for(let a=u.value.length-1;a>=0;a--){const T=u.value[a].slug,C=document.querySelector(`#${T}`);if((C?C.getBoundingClientRect().top:0)<=100){e.activeLink=T;break}}window.pageYOffset>e.headerHeight+m-S?(e.isFixed=!0,e.catalogTop=S):(e.isFixed=!1,e.catalogTop=e.headerHeight+m)},d=()=>{const t=document.querySelector(".post-header");e.headerHeight=t?t.offsetHeight:0,e.screenWidth=document.body.clientWidth,e.catalogTop=e.headerHeight+m};let y;z(()=>{window.addEventListener("scroll",p),d(),window.onresize=()=>(()=>{d(),p()})(),y=o.afterEach(()=>{d()})}),A(()=>{window.removeEventListener("scroll",p),y()});const{post:g}=V(),v=f(()=>{if(!g.value)return{};const t=g.value.info.next;t&&(t.text=r.value.postNext);const a=g.value.info.prev;return a&&(a.text=r.value.postPrev),{next:t,prev:a}});return(t,a)=>(l(),c(Q,null,{page:h(()=>[P(W,{name:"fade-slide-y",mode:"out-in",onBeforeEnter:s($),onBeforeLeave:s(b)},{default:h(()=>[O("div",{class:H(["post-wrapper",{"show-catalog":s(i)}])},[U(P(I,{class:"post-header"},null,512),[[j,s(n).title]]),(l(),c(J,{key:s(n).path,class:"post-content"},{bottom:h(()=>[v.value.next||v.value.prev?(l(),c(X,{key:0,data:v.value},null,8,["data"])):L("",!0)]),_:1})),s(i)?(l(),c(s(k),{key:0,headers:u.value,"active-link":e.activeLink,class:H({fixed:e.isFixed}),style:G({top:`${e.catalogTop}px`})},null,8,["headers","active-link","class","style"])):L("",!0)],2)]),_:1},8,["onBeforeEnter","onBeforeLeave"])]),_:1}))}});var re=N(Z,[["__file","Post.vue"]]);export{re as default};
